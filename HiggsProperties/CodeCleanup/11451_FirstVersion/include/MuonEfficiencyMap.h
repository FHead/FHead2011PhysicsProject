inline unsigned int FindMuonEfficiencyBin( const double value, const double bins[], unsigned int nbins) {
  unsigned int nbinboundaries = nbins+1;
  unsigned int bin = 0;
  for (uint i=0; i < nbinboundaries; ++i) {
    if (i < nbinboundaries-1) {
      if (value >= bins[i] && value < bins[i+1]) {
        bin = i+1;
        break;
      }
    } else if (i == nbinboundaries-1) {
      if (value >= bins[i]) {
        bin = nbinboundaries;
        break;
      }
    }    
  }
  return bin;
}


double GetMuonEfficiencyPtEtaPhi(double Pt, double Eta, double Phi) {

  static const double ptBins[16] = {5,6,7,8,9,10,12,14,16,18,20,25,30,35,40,50};
  static const double etaBins[17] = {0,0.2,0.4,0.6,0.8,1,1.2,1.4442,1.566,1.8,2,2.1,2.2,2.3,2.4,2.5,2.6};
  static const double phiBins[13] = {-3.2,-2.5,-2,-1.5,-1,-0.5,0,0.5,1,1.5,2,2.5,3.2};


  static const double Efficiency[17][18][14]  = {
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.015625,0.05,0.0526316,0,0.0181818,0.140351,0.0555556,0.015873,0.0208333,0.0163934,0.0350877,0.015625,0},
      {0,0.0144928,0,0.0508475,0,0.0576923,0.0217391,0.0307692,0.0327869,0.0434783,0.0227273,0.0576923,0.0327869,0},
      {0,0.0147059,0.0612245,0.0666667,0.0238095,0.0714286,0.0263158,0,0,0.0192308,0.0465116,0.0576923,0,0},
      {0,0.0178571,0,0,0.0576923,0,0.05,0,0,0.0185185,0.0793651,0.0185185,0,0},
      {0,0.0384615,0,0.0714286,0.0666667,0.0350877,0.047619,0.0227273,0.0392157,0.0769231,0.0212766,0.0188679,0,0},
      {0,0.0185185,0.0238095,0.0588235,0.027027,0.0566038,0,0.0208333,0,0.0408163,0.0638298,0.0655738,0.0508475,0},
      {0,0.025,0.0677966,0.015625,0.0188679,0.0204082,0.0350877,0.04,0.0217391,0.0517241,0,0.0461538,0.0119048,0},
      {0,0.0625,0.030303,0,0,0.0526316,0.0689655,0,0,0,0.0588235,0,0.0277778,0},
      {0,0.0277778,0,0.0208333,0.0188679,0,0.0576923,0.0243902,0,0.0645161,0,0,0,0},
      {0,0.0625,0.0444444,0.027027,0.0232558,0,0,0,0,0.0192308,0,0,0,0},
      {0,0.037037,0,0.047619,0,0,0,0.0588235,0,0.0454545,0,0.047619,0,0},
      {0,0.03125,0.0769231,0.0357143,0,0.04,0,0,0.047619,0,0,0,0.04,0},
      {0,0,0,0,0.05,0,0,0,0.0588235,0.0555556,0,0,0,0},
      {0,0,0.133333,0,0.0588235,0,0,0.0454545,0.0454545,0,0.0625,0,0.0384615,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.882353,0.967742,0.964286,0.827586,0.8,0.85,0.909091,0.925926,0.916667,0.888889,0.916667,0.851852,0},
      {0,0.903226,0.88,0.903226,0.896552,0.8,0.913043,0.791667,0.95,0.916667,0.96,0.9,0.868421,0},
      {0,0.92,0.833333,0.928571,0.913043,0.947368,0.947368,0.892857,0.85,0.846154,0.96,0.909091,0.861111,0},
      {0,0.823529,0.904762,0.923077,0.9375,1,1,0.928571,0.785714,0.916667,1,0.848485,0.866667,0},
      {0,0.888889,0.894737,0.84,1,1,0.846154,0.958333,0.882353,0.95,0.857143,0.962963,0.857143,0},
      {0,0.942857,0.888889,0.958333,0.894737,0.904762,0.933333,0.884615,0.9,0.85,0.888889,0.913043,0.833333,0},
      {0,0.878788,0.862069,0.9375,0.7,0.823529,0.962963,0.875,0.8,0.896552,0.833333,0.761905,0.787879,0},
      {0,1,0.833333,0.916667,0.733333,0.875,0.7,0.8,0.75,0.928571,0.888889,1,0.928571,0},
      {0,0.851852,0.76,0.88,0.833333,0.85,0.941176,0.85,0.85,0.869565,0.9375,0.8,0.952381,0},
      {0,0.935484,0.909091,0.818182,1,0.769231,1,0.809524,0.733333,0.8,0.944444,0.875,0.857143,0},
      {0,0.75,0.75,0.9,0.777778,1,0.875,1,0.909091,1,1,0.818182,0.777778,0},
      {0,0.909091,0.888889,1,0.727273,0.888889,0.75,1,1,0.8,0.8,0.727273,0.888889,0},
      {0,1,0.857143,0.8,0.714286,0.333333,1,1,0.857143,0.857143,1,1,0.941176,0},
      {0,0.6,0.666667,0.857143,1,0.857143,0.857143,0.5,1,0.5,0.833333,1,0.727273,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.895833,0.962963,1,0.903226,0.911765,0.916667,0.918919,1,0.866667,0.96875,1,0.935484,0},
      {0,0.931818,0.931034,0.96,0.96875,0.947368,0.892857,0.967742,0.956522,0.962963,0.967742,0.945946,0.909091,0},
      {0,0.945946,0.897436,1,1,1,1,0.95122,0.964286,0.939394,0.95,0.92,0.916667,0},
      {0,0.931034,0.970588,1,0.851852,0.918919,0.935484,0.909091,0.846154,0.96875,0.892857,0.933333,1,0},
      {0,0.972973,0.928571,0.904762,1,0.961538,0.84375,1,0.965517,0.918919,0.972973,0.970588,0.888889,0},
      {0,0.939394,1,0.952381,0.947368,0.965517,0.962963,0.931034,0.970588,0.909091,0.962963,0.961538,0.947368,0},
      {0,0.886364,0.9375,0.9,0.952381,0.967742,0.861111,0.971429,0.857143,0.92,0.891892,0.977273,1,0},
      {0,0.846154,0.944444,1,0.869565,0.909091,0.923077,0.733333,0.9375,0.941176,1,0.923077,1,0},
      {0,0.971429,0.962963,0.923077,0.9,0.9,0.928571,1,1,0.954545,0.851852,0.933333,0.903226,0},
      {0,0.862069,1,1,1,0.888889,0.958333,1,1,0.928571,1,0.85,0.970588,0},
      {0,0.833333,1,0.875,1,1,0.933333,1,0.916667,0.888889,1,1,0.8,0},
      {0,0.923077,0.666667,1,1,0.833333,1,0.875,1,1,0.857143,1,0.9,0},
      {0,1,0.9,0.833333,1,0.666667,1,1,1,1,1,0.875,0.8,0},
      {0,0.857143,0.8125,1,0.909091,0.714286,1,0.75,1,1,0.75,0.777778,0.818182,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.948276,0.939394,0.978261,0.966667,0.964912,0.97561,0.933333,0.966667,0.95,0.897436,1,0.961538,0},
      {0,0.979592,0.944444,0.973684,0.90625,1,0.941176,0.891892,0.928571,1,1,0.933333,1,0},
      {0,0.953488,0.933333,1,0.9375,0.916667,1,1,0.958333,1,0.966667,0.947368,0.962264,0},
      {0,0.959184,0.96875,0.935484,0.90625,0.9375,0.966667,0.958333,1,0.939394,0.970588,0.970588,0.918919,0},
      {0,0.926829,0.970588,1,0.956522,0.948718,0.948718,0.894737,0.941176,0.956522,0.964286,0.975,0.914894,0},
      {0,0.955556,0.965517,0.965517,0.913043,1,0.939394,0.967742,0.888889,1,0.964286,0.965517,0.930233,0},
      {0,1,0.928571,0.952381,0.933333,0.871795,0.923077,0.967742,1,0.944444,0.857143,0.97619,0.970588,0},
      {0,0.952381,1,1,1,0.9375,1,0.923077,1,0.944444,1,0.944444,0.962963,0},
      {0,1,0.961538,0.909091,1,1,1,0.939394,0.942857,0.909091,0.942857,0.869565,1,0},
      {0,1,0.961538,1,0.916667,1,0.928571,0.892857,1,0.92,0.952381,0.95,0.972222,0},
      {0,1,0.916667,0.777778,0.947368,1,0.857143,0.923077,1,1,0.818182,0.833333,1,0},
      {0,0.9,0.7,0.888889,0.75,1,0.777778,0.875,0.875,1,0.75,0.923077,0.818182,0},
      {0,1,1,1,1,1,1,0.857143,1,0.833333,0.923077,1,1,0},
      {0,1,0.75,1,0.875,0.857143,0.916667,1,1,1,0.818182,1,0.923077,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.960784,0.976744,0.948718,0.977778,0.97561,1,0.945946,0.957447,0.977273,0.921053,0.979167,0.96,0},
      {0,0.980392,0.955556,0.945946,0.902439,0.97561,0.947368,0.928571,0.925926,0.973684,0.977778,0.947368,0.958333,0},
      {0,0.981132,0.974359,1,0.972973,0.914894,0.942857,1,0.972222,0.953488,1,0.891304,0.954545,0},
      {0,0.97561,0.96875,0.961538,0.973684,1,0.972222,0.961538,0.96,0.918919,1,1,0.978723,0},
      {0,1,0.95122,0.944444,1,0.862069,1,0.967742,0.961538,0.9,0.972222,0.884615,0.95122,0},
      {0,0.953488,0.95,0.965517,0.923077,0.961538,0.976744,0.918919,0.870968,0.972973,0.923077,0.892857,0.925,0},
      {0,0.926829,0.948718,0.976744,0.971429,0.952381,0.975,0.935484,0.947368,0.9375,0.926829,0.971429,1,0},
      {0,0.95,0.928571,1,0.941176,0.944444,0.923077,0.833333,1,1,0.944444,0.9,0.966667,0},
      {0,1,0.909091,0.96875,0.933333,0.966667,0.965517,0.96,1,0.962963,0.975,0.935484,0.98,0},
      {0,0.923077,0.958333,0.92,0.958333,0.857143,1,0.95,0.96,1,0.958333,0.962963,0.952381,0},
      {0,1,0.833333,0.909091,0.875,0.909091,1,0.888889,1,1,1,1,1,0},
      {0,1,1,0.916667,1,0.909091,0.888889,1,0.916667,0.916667,0.833333,0.866667,1,0},
      {0,1,1,1,0.75,1,0.9,0.923077,1,1,0.9,1,1,0},
      {0,0.833333,1,0.7,0.888889,0.666667,1,0.727273,1,1,0.75,0.6,1,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.964912,0.980392,0.98,0.967742,0.97619,0.916667,0.945946,0.980392,0.973684,0.953488,1,0.983871,0},
      {0,0.948718,0.972973,0.955556,0.913043,0.972222,0.974359,0.954545,1,0.923077,0.973684,0.914286,0.981132,0},
      {0,0.953125,0.97561,0.971429,0.974359,0.971429,0.948718,0.973684,1,1,1,0.971429,0.961538,0},
      {0,1,0.971429,1,1,0.939394,0.952381,0.97619,1,1,0.971429,1,0.980769,0},
      {0,0.885714,0.970588,0.976744,0.969697,0.970588,0.941176,1,1,0.942857,1,0.970588,0.980769,0},
      {0,0.981132,1,1,0.909091,0.962963,0.972973,0.914286,0.952381,1,0.97561,0.972222,0.95,0},
      {0,0.956522,0.857143,0.942308,0.909091,0.953488,1,0.975,0.947368,0.95,0.953488,0.9375,0.95,0},
      {0,0.956522,1,0.736842,1,1,1,0.92,0.9375,1,1,1,0.944444,0},
      {0,1,1,0.964286,0.942857,1,0.969697,0.878788,0.880952,0.97561,0.958333,1,0.941176,0},
      {0,0.864865,0.947368,1,1,0.965517,0.935484,1,0.96,0.962963,0.921053,1,0.878788,0},
      {0,0.923077,0.875,0.888889,0.888889,1,1,1,0.923077,0.964286,1,1,1,0},
      {0,0.833333,1,1,1,1,1,0.818182,1,0.909091,0.923077,0.9375,1,0},
      {0,1,1,1,1,0.75,1,1,1,1,0.75,0.928571,1,0},
      {0,0.916667,1,1,0.833333,0.75,0.909091,1,0.888889,1,1,1,0.928571,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.966102,0.954545,0.987013,0.975309,0.9375,0.961538,0.95122,0.967391,0.959596,0.97561,0.954545,0.964286,0},
      {0,0.948276,0.974684,0.953488,0.97,1,0.963415,0.987179,0.969072,0.990099,0.976471,1,0.979592,0},
      {0,0.959677,0.978261,0.964286,0.965909,0.977011,0.967033,0.977011,0.976744,0.989011,0.946667,0.987805,0.968,0},
      {0,0.961905,0.987952,0.987654,0.976744,0.989796,0.980583,0.986486,1,0.9625,0.987805,0.987342,0.990654,0},
      {0,0.978947,0.945205,0.956522,0.941176,0.948718,0.986111,0.966667,0.95122,0.986111,0.960396,0.972973,0.97,0},
      {0,0.941748,0.966667,0.968254,0.974026,0.944444,0.929825,0.971014,1,0.962963,0.973684,0.972603,0.975904,0},
      {0,0.938596,0.957895,0.97619,0.931507,0.962025,0.979381,0.989247,0.97561,0.966292,0.97561,1,0.981651,0},
      {0,0.980769,0.980392,0.973684,0.888889,0.97619,1,1,0.972222,0.948718,0.97561,1,0.948276,0},
      {0,0.952941,0.949153,0.956522,1,0.96875,0.973684,0.983607,0.95082,0.961538,0.912281,0.910448,1,0},
      {0,0.969231,1,0.959184,1,0.978723,0.978261,0.931818,0.97619,0.967742,0.983871,0.978723,1,0},
      {0,0.9375,1,0.9,0.904762,1,0.9,0.96,0.925926,1,1,1,0.9375,0},
      {0,0.956522,0.875,0.888889,0.923077,0.928571,0.875,1,0.933333,0.925926,0.928571,1,0.931034,0},
      {0,0.882353,1,0.923077,0.952381,1,1,0.952381,0.888889,0.866667,0.95,1,1,0},
      {0,0.966667,0.894737,1,1,0.923077,0.944444,1,0.916667,1,0.95,0.964286,0.941176,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.991667,0.97541,0.954023,0.966102,0.973214,0.978261,0.990196,0.981132,0.990566,0.981651,0.989247,0.991935,0},
      {0,0.959677,0.989011,0.958333,0.989362,1,0.979167,0.955556,0.968421,1,0.952941,0.989474,0.977273,0},
      {0,0.990909,0.962264,0.967033,0.965116,0.987654,1,1,0.939759,0.989474,0.962025,0.962617,0.976744,0},
      {0,1,0.989583,0.977528,0.977011,0.969072,0.9625,0.989362,0.988095,0.95122,0.968085,0.989247,1,0},
      {0,0.961905,0.976744,0.975904,0.975309,1,0.961165,0.969388,0.968421,0.975309,0.971831,0.961538,0.962617,0},
      {0,0.956897,0.970588,0.985294,0.989362,0.987179,0.958904,1,0.988506,1,0.961039,0.970149,0.978022,0},
      {0,0.934783,0.989011,0.972477,0.930233,0.986486,0.94,0.956522,0.987013,0.971963,0.956044,0.977273,0.977011,0},
      {0,0.967742,1,0.945946,0.95122,0.977273,1,1,0.972222,0.956522,0.969697,1,0.982456,0},
      {0,0.980583,0.961538,0.984127,0.962264,0.966667,0.981818,0.970588,0.964912,1,0.985507,0.972973,0.95,0},
      {0,0.966667,0.980392,0.982143,0.949153,0.962264,0.979592,1,0.960784,0.97619,0.973684,0.984615,0.987342,0},
      {0,1,0.941176,0.869565,1,1,0.96,1,0.923077,0.961538,0.923077,1,0.969697,0},
      {0,1,0.916667,0.947368,0.954545,1,0.916667,1,0.964286,0.888889,1,0.944444,0.967742,0},
      {0,0.913043,0.933333,0.947368,0.944444,1,0.95,1,0.888889,1,0.956522,1,1,0},
      {0,0.777778,1,0.894737,1,0.909091,1,0.857143,0.9375,0.952381,1,1,0.888889,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.990476,0.99,0.987013,0.987952,1,0.987654,0.965116,0.978261,0.981132,1,0.987342,1,0},
      {0,0.96748,0.988372,0.99,0.951807,1,0.949367,0.970297,0.990291,0.96875,0.949495,1,1,0},
      {0,0.982143,0.988506,0.990654,0.990566,1,0.985915,1,0.988372,0.97561,0.988506,0.942529,0.981818,0},
      {0,0.984127,0.987952,0.978261,0.976744,0.988506,0.977528,1,0.974684,0.970297,0.976471,0.967742,0.990566,0},
      {0,1,0.955882,0.975904,0.973333,0.972973,0.987952,0.977528,0.987342,1,0.968085,0.960526,0.982456,0},
      {0,0.98,1,0.96,0.953488,0.987013,0.971429,0.975309,0.969697,1,0.987013,0.966667,0.966942,0},
      {0,0.981651,0.970297,0.987179,0.967033,0.987179,0.9875,0.964286,1,0.989691,0.986111,1,0.951923,0},
      {0,0.944444,0.975,0.971429,1,0.9375,0.971429,0.916667,1,0.977778,0.964286,0.97619,1,0},
      {0,0.988764,0.970588,1,0.962963,0.971429,0.957447,0.927273,0.984375,0.986301,0.969231,0.964912,0.950617,0},
      {0,0.969697,1,0.97619,0.977273,0.977273,1,0.977778,0.959184,0.95,1,0.978261,1,0},
      {0,0.866667,1,1,0.933333,0.857143,1,1,1,1,1,1,1,0},
      {0,0.9375,0.875,1,0.928571,1,0.875,0.894737,1,1,0.944444,0.92,0.941176,0},
      {0,0.903226,0.956522,0.791667,1,0.9,0.866667,0.9,1,0.8125,0.941176,0.8,0.925926,0},
      {0,0.842105,1,0.789474,0.875,0.947368,0.95,0.882353,0.95,0.916667,1,0.923077,1,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.990909,0.954545,0.973684,0.985915,0.959459,0.973684,0.979167,0.962025,1,0.956044,0.9875,0.980392,0},
      {0,0.970874,0.97619,0.989796,0.987342,0.981481,0.95122,0.947368,1,0.987179,0.977778,0.975,0.982906,0},
      {0,0.965909,1,0.987805,1,0.979798,0.952941,0.986667,0.987805,0.959459,1,1,1,0},
      {0,0.971154,0.986301,0.985507,0.989247,0.973333,0.965909,0.986842,0.957143,0.984375,0.977011,0.984375,0.980952,0},
      {0,0.980583,0.986486,1,0.977011,0.963415,1,1,0.973333,0.987013,0.985714,0.962963,0.990196,0},
      {0,0.957895,0.974684,0.985507,0.942029,0.958333,0.948276,0.957143,0.964912,0.942029,1,0.956522,0.974359,0},
      {0,0.989474,0.987805,0.985507,0.986301,0.988235,0.974684,0.987013,0.959459,0.952381,0.971429,1,0.978261,0},
      {0,0.979592,1,0.925926,0.969697,0.965517,0.903226,0.97561,1,1,0.941176,0.96875,1,0},
      {0,0.961039,0.987654,0.966102,1,1,1,0.896552,1,1,0.947368,0.985714,1,0},
      {0,0.982456,0.97561,0.930233,0.959184,0.947368,0.962963,1,0.93617,1,0.978261,0.954545,0.964286,0},
      {0,0.964286,1,0.947368,0.956522,0.933333,1,1,1,1,1,1,0.966667,0},
      {0,0.888889,0.954545,1,0.909091,0.846154,1,0.913043,0.869565,1,1,1,0.956522,0},
      {0,1,0.875,1,0.952381,1,1,0.888889,0.866667,1,1,0.9,0.96,0},
      {0,0.952381,1,0.923077,1,0.846154,1,0.846154,0.882353,1,0.933333,0.875,0.888889,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.964912,0.974684,0.988889,1,1,0.977778,0.978495,0.986842,0.986111,0.986301,0.957746,0.964286,0},
      {0,0.99115,0.989011,1,0.971429,0.967742,0.988235,1,0.986111,1,1,0.966292,0.99115,0},
      {0,0.979798,0.97561,0.988636,0.986301,1,0.973333,0.987952,0.987013,0.967742,0.987952,1,0.976471,0},
      {0,0.987654,0.986301,0.987654,0.988636,0.984127,0.974026,0.946667,0.962025,0.973684,0.986111,0.972603,1,0},
      {0,0.975,0.971831,0.955882,0.971014,0.988636,1,1,0.968254,0.987179,0.972973,1,0.977273,0},
      {0,0.985714,0.971831,0.939394,0.986111,0.980769,0.985075,0.966102,1,0.968254,0.985714,0.971429,1,0},
      {0,0.948454,0.955224,0.97561,0.974359,0.954545,0.957143,0.986667,0.975904,0.953125,0.976744,0.947368,0.97561,0},
      {0,1,1,1,0.928571,1,0.909091,1,0.974359,1,1,1,0.952381,0},
      {0,0.941176,0.981818,0.955224,0.969231,1,0.956522,0.948718,0.979592,0.981818,0.961538,0.983607,1,0},
      {0,0.960784,0.973684,0.953488,0.97619,0.979592,0.948718,0.977778,1,1,0.977778,0.967742,0.983333,0},
      {0,1,1,1,0.863636,1,1,1,0.904762,1,1,1,1,0},
      {0,0.866667,0.9,1,0.916667,0.944444,0.95,0.833333,1,0.933333,0.952381,0.85,0.862069,0},
      {0,1,0.818182,1,1,0.947368,1,0.928571,0.9375,0.909091,1,1,1,0},
      {0,0.842105,1,0.909091,0.928571,1,1,1,1,1,0.882353,1,0.947368,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.984456,0.988304,0.988506,1,0.977401,0.963636,0.981928,0.993789,0.976471,0.993464,0.993976,0.978166,0},
      {0,0.986364,0.982249,0.98895,0.988304,0.980263,0.993671,1,0.965035,0.987342,0.981366,0.987578,0.964286,0},
      {0,0.986425,0.986928,0.980132,0.986014,0.969512,0.987421,0.986755,0.971014,0.975904,0.947761,0.976744,0.980488,0},
      {0,1,0.984252,0.982353,0.98773,0.973154,1,0.983146,0.972789,0.982955,0.962264,0.972028,0.975369,0},
      {0,0.982659,0.986577,1,0.965986,0.992188,0.958678,0.986577,0.979866,1,0.958904,0.992366,0.950276,0},
      {0,0.989247,0.991453,0.961832,0.983471,0.978417,0.984375,0.969466,0.986667,0.992647,0.985612,0.960317,0.965517,0},
      {0,0.973545,0.987342,0.967949,0.965035,0.976923,0.984615,0.959016,0.986755,0.992754,0.952381,0.981366,0.953216,0},
      {0,0.964706,0.940299,0.987013,0.961538,0.967742,0.955224,0.986301,0.969697,0.951613,1,0.970588,0.960526,0},
      {0,0.971631,0.971154,1,0.952756,0.97541,0.982906,0.97561,0.939189,0.978261,1,0.972727,0.986395,0},
      {0,0.957265,0.936709,0.988506,0.977528,0.946809,1,1,0.976744,1,0.973684,1,1,0},
      {0,0.966667,0.97561,0.975,0.972222,1,0.962963,0.95122,1,1,1,1,1,0},
      {0,0.977778,0.914286,0.954545,0.804878,0.97561,0.875,0.952381,0.916667,0.95,1,0.95,1,0},
      {0,0.952381,0.935484,0.973684,0.923077,0.969697,1,0.928571,1,1,0.909091,0.965517,1,0},
      {0,0.944444,0.967742,0.926829,0.892857,0.923077,0.885714,0.925926,1,0.941176,1,0.969697,0.941176,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.972826,0.993103,1,0.977099,0.985401,0.976378,0.97973,0.974522,0.992647,0.992188,0.953125,0.99375,0},
      {0,0.993421,0.984,0.992908,0.944444,0.993151,0.963235,1,0.950355,0.978102,0.966887,0.992857,1,0},
      {0,0.978836,1,0.965278,0.992424,0.976562,0.992308,0.99187,0.982456,0.985714,0.975,0.992248,0.989011,0},
      {0,0.983516,0.968,0.992126,0.992063,0.978261,0.96748,0.972727,0.990991,0.99187,1,0.991667,0.993197,0},
      {0,0.993289,1,1,0.990991,0.981481,0.966667,0.970149,0.957746,0.976,0.988889,0.980392,0.976048,0},
      {0,0.993377,0.990741,0.961538,1,0.95614,0.982759,0.980952,0.990826,0.962963,1,0.991304,0.965517,0},
      {0,0.993548,0.977099,0.974359,0.962963,0.955556,0.981818,1,0.981818,0.968254,1,1,0.977143,0},
      {0,1,0.909091,0.960784,1,1,0.979592,0.961538,0.987342,0.966667,1,0.971831,0.947368,0},
      {0,0.991597,0.979798,0.989796,0.981308,0.979592,0.971154,0.960396,0.956989,0.968421,0.966292,0.976744,0.976,0},
      {0,0.93,0.9875,1,0.985915,1,0.985507,0.987342,1,1,0.982456,0.966102,1,0},
      {0,0.971429,0.939394,0.967742,1,1,1,0.972973,0.973684,0.969697,0.979167,0.972973,0.97619,0},
      {0,0.972222,1,0.928571,0.956522,0.944444,0.931034,0.931034,0.9375,0.925,0.935484,0.862069,0.970588,0},
      {0,0.884615,1,0.88,0.861111,0.928571,1,1,1,1,0.914286,0.964286,1,0},
      {0,0.861111,0.866667,1,0.954545,0.935484,0.9375,0.869565,0.913043,0.904762,0.966667,0.952381,0.931034,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.993789,0.992701,0.97037,0.96063,0.969231,0.993103,1,0.979167,0.972973,1,1,0.989011,0},
      {0,0.994413,0.993103,0.991525,0.976562,0.967742,0.992481,1,0.945736,0.977778,0.985915,0.991597,0.981595,0},
      {0,0.97931,0.991597,0.980952,0.992754,0.965517,0.984496,0.981982,0.992857,0.992366,0.991803,1,0.99422,0},
      {0,0.986755,0.991736,0.984252,0.975,0.984,1,0.991304,0.991935,0.980952,0.990654,0.968992,1,0},
      {0,0.985294,0.990566,0.981818,0.990291,0.981818,0.981982,0.982143,0.975806,0.99115,0.991667,0.988636,1,0},
      {0,0.978417,0.961039,0.953704,0.978261,0.972477,0.965517,0.990385,0.957447,0.977528,1,0.954955,0.962406,0},
      {0,0.992857,0.982759,0.970874,0.954887,0.977612,0.964029,0.99187,0.938776,0.957265,1,0.963303,0.976744,0},
      {0,0.984615,0.980769,0.979167,0.962963,1,0.929825,1,0.98,0.983051,0.983333,0.982759,1,0},
      {0,1,0.975,0.97561,0.989474,0.980952,0.964286,0.941176,0.954023,0.989899,0.978022,0.980583,0.990741,0},
      {0,0.987654,1,0.946429,0.95082,0.984615,0.98,0.921875,0.985075,0.986486,1,0.982759,0.988095,0},
      {0,0.947368,1,1,1,0.942857,0.935484,0.967742,1,1,0.931034,1,0.970588,0},
      {0,0.914286,0.931034,0.833333,0.956522,1,1,0.88,0.954545,1,1,1,0.966667,0},
      {0,0.782609,0.925926,1,0.965517,1,1,0.961538,0.954545,1,1,0.964286,1,0},
      {0,1,0.846154,0.892857,0.821429,0.826087,1,0.913043,0.916667,0.875,0.909091,0.931034,0.972973,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.975155,0.979167,0.97037,0.990291,0.987179,0.983871,1,0.977612,1,0.991379,0.976923,0.989247,0},
      {0,0.983607,0.983607,0.991525,0.984962,0.983871,0.958042,0.985294,0.971014,1,0.984252,0.979167,0.989189,0},
      {0,0.979866,0.982759,1,0.993151,0.993103,0.982906,0.990654,0.973684,0.984,0.99187,1,0.982143,0},
      {0,0.986486,1,1,0.982143,0.992701,0.992188,0.991453,0.977273,0.982301,0.992806,0.984733,1,0},
      {0,0.983193,0.974576,0.981818,1,0.984,0.976378,0.982906,0.968,0.980392,0.992366,0.980769,1,0},
      {0,0.977273,0.955224,0.980769,0.978022,0.990741,0.979592,0.991803,0.963303,0.99,0.984,0.974138,1,0},
      {0,0.992537,0.964602,0.954545,0.990741,0.990099,0.962617,0.976,0.967213,0.97561,0.981481,0.97619,0.966216,0},
      {0,0.987013,0.97561,0.944444,0.948276,0.979592,0.981481,1,0.966102,0.972973,1,0.981818,0.983871,0},
      {0,0.991304,1,0.961905,0.979592,0.99,0.968421,0.97,0.968421,0.973333,0.988235,0.961039,0.991525,0},
      {0,0.955556,0.986842,1,1,0.983051,0.970588,0.985714,0.984848,0.960526,1,0.982456,0.978022,0},
      {0,1,0.939394,1,1,1,1,1,0.96,0.970588,0.962963,0.909091,0.933333,0},
      {0,0.95122,0.935484,1,0.935484,1,1,1,0.909091,0.966667,0.92,0.965517,0.947368,0},
      {0,0.9375,0.956522,0.92,0.9,0.92,1,0.894737,1,0.903226,1,0.952381,0.972222,0},
      {0,0.928571,0.75,0.92,0.947368,0.961538,0.952381,0.904762,0.884615,0.923077,0.863636,0.823529,0.92,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.985915,0.979058,0.990476,0.978541,0.972222,0.984925,0.995327,0.980676,0.97807,1,0.991189,0.996337,0},
      {0,0.990164,0.994624,0.974227,0.986175,0.970588,0.995146,0.985294,0.985,0.967742,0.982063,0.986784,0.988235,0},
      {0,0.992032,0.981221,0.970443,0.97807,0.985714,0.975845,0.995098,1,0.995833,0.982063,0.982759,0.989247,0},
      {0,0.988764,0.995392,0.995614,0.984293,0.99,0.986047,0.975845,0.994286,1,0.988571,0.979592,0.991935,0},
      {0,0.995833,0.994764,1,0.993789,0.994536,0.994737,0.989011,0.974227,1,0.99375,0.97191,0.977169,0},
      {0,0.995215,0.988372,0.983425,0.989418,0.974359,0.945455,0.974194,0.966887,0.989071,0.973404,0.98995,0.986726,0},
      {0,0.982906,0.989796,0.984848,0.970443,0.979381,0.971098,0.99,0.989305,1,0.982659,1,0.97619,0},
      {0,0.982143,1,0.987013,0.987952,0.987805,0.987179,0.978261,1,1,0.96875,0.979167,1,0},
      {0,0.979695,0.974522,0.95,0.985612,0.97973,0.986014,0.97076,0.966216,0.993197,0.97973,0.976,0.967742,0},
      {0,0.968504,0.976744,0.991228,0.989899,0.98,0.981982,0.973451,0.991453,0.990909,1,0.961165,0.985294,0},
      {0,0.947368,0.979592,0.971429,1,0.978261,0.974359,0.956522,1,0.978723,0.944444,0.979592,1,0},
      {0,0.880952,0.97619,0.978723,0.969697,0.925,0.953488,0.95,0.928571,0.977273,0.970588,0.941176,0.980769,0},
      {0,0.947368,0.945946,0.97619,0.906977,0.895833,1,0.967742,0.90625,0.926829,0.980769,0.970588,0.953488,0},
      {0,0.87234,0.885714,0.972222,0.933333,0.925,0.939394,0.933333,0.83871,0.894737,0.9,0.923077,0.897959,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    },
    {
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0.991701,0.994764,0.985,0.974093,0.994565,0.991071,0.989637,0.99537,1,0.994819,1,0.995868,0},
      {0,0.989051,0.989583,1,0.994536,0.986425,0.99,0.985,0.989418,0.939086,0.978378,0.994595,0.995902,0},
      {0,0.986726,0.989796,1,0.994898,0.989071,0.994505,1,1,0.990476,0.989796,0.984127,1,0},
      {0,0.995885,1,0.993631,0.98895,1,0.989418,0.988439,0.982759,0.994949,0.977011,0.994681,0.995633,0},
      {0,0.990909,0.981132,0.979866,0.98913,0.987879,0.99375,0.975758,0.987879,0.982659,0.994286,0.993865,0.987013,0},
      {0,0.995413,0.97619,0.984252,0.974522,0.978417,0.99359,0.992126,0.98125,0.993789,0.987805,0.992908,0.990148,0},
      {0,0.986111,0.994048,0.973856,0.988166,0.980769,0.988304,0.993711,0.993506,0.98,1,0.993976,0.985981,0},
      {0,0.990385,1,0.987952,0.975309,0.974026,0.985294,1,0.986842,0.972222,1,1,0.970874,0},
      {0,0.986928,0.991736,0.991453,0.973913,0.991525,0.990566,0.982301,0.943925,0.97561,1,0.984127,0.993289,0},
      {0,0.982609,0.951807,0.939394,0.987805,0.986111,0.979167,0.988764,1,1,0.988636,0.975904,0.973684,0},
      {0,1,1,0.942857,0.97561,0.921053,1,1,0.970588,0.952381,1,1,1,0},
      {0,0.9,0.939394,1,1,0.909091,1,1,0.967742,0.948718,0.954545,0.939394,0.957447,0},
      {0,0.928571,1,0.969697,0.933333,0.956522,1,0.966667,0.96,0.92,0.967742,0.970588,1,0},
      {0,0.878788,0.888889,0.8125,0.914286,0.842105,0.875,0.914286,1,0.923077,1,0.857143,0.975,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0},
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0}
}
};


  int tmpPtBin = FindMuonEfficiencyBin( Pt , ptBins, 15);
  int tmpEtaBin = FindMuonEfficiencyBin( Eta , etaBins, 16);
  int tmpPhiBin = FindMuonEfficiencyBin( Phi , phiBins, 12);
  return Efficiency[tmpPtBin][tmpEtaBin][tmpPhiBin];
}




double GetMuonEfficiencyPtEta(double Pt, double Eta) {

  static const double ptBins[16] = {5,6,7,8,9,10,12,14,16,18,20,25,30,35,40,50};
  static const double etaBins[17] = {0,0.2,0.4,0.6,0.8,1,1.2,1.4442,1.566,1.8,2,2.1,2.2,2.3,2.4,2.5,2.6};


  static const double Efficiency[17][18] = {
    {0,0.0357143,0.0302115,0.0302013,0.0221169,0.035313,0.0359477,0.0290055,0.02849,0.0183206,0.0169173,0.0212766,0.0238095,0.0124481,0.0309735,0,0,0    },
    {0,0.891641,0.891813,0.903846,0.89644,0.912892,0.901024,0.841121,0.857143,0.866197,0.866667,0.862745,0.839623,0.87013,0.7625,0,0,0    },
    {0,0.933687,0.943445,0.955959,0.934605,0.943243,0.955357,0.926702,0.913295,0.933735,0.953668,0.9375,0.910112,0.947368,0.871795,0,0,0    },
    {0,0.956612,0.959459,0.964455,0.952141,0.947115,0.954178,0.945107,0.969072,0.959459,0.956204,0.928571,0.856,0.965217,0.923077,0,0,0    },
    {0,0.966165,0.951737,0.961303,0.973034,0.947631,0.936893,0.955357,0.942029,0.964646,0.95053,0.952,0.929688,0.958333,0.865385,0,0,0    },
    {0,0.970534,0.957317,0.972917,0.982646,0.968539,0.966368,0.947368,0.951456,0.957245,0.945455,0.955224,0.951389,0.961832,0.938931,0,0,0    },
    {0,0.962667,0.975521,0.971223,0.982938,0.964066,0.965169,0.969216,0.97076,0.961071,0.977236,0.951311,0.932271,0.954733,0.957265,0,0,0    },
    {0,0.980635,0.976311,0.975287,0.981149,0.970837,0.978216,0.964351,0.975155,0.973006,0.975721,0.962712,0.96139,0.954955,0.926407,0,0,0    },
    {0,0.988278,0.977312,0.984657,0.981395,0.979904,0.975485,0.980095,0.96888,0.970551,0.981197,0.975945,0.938356,0.898734,0.923404,0,0,0    },
    {0,0.975705,0.977612,0.985366,0.978306,0.983723,0.964365,0.980126,0.971014,0.979975,0.966667,0.98062,0.947761,0.953917,0.930108,0,0,0    },
    {0,0.979612,0.988131,0.984144,0.979121,0.980482,0.979038,0.965821,0.980198,0.971256,0.975881,0.975845,0.912863,0.965116,0.947712,0,0,0    },
    {0,0.984667,0.983736,0.978539,0.981604,0.978941,0.979142,0.973032,0.968822,0.974162,0.979554,0.983051,0.941788,0.962865,0.940874,0,0,0    },
    {0,0.982709,0.98024,0.985101,0.985065,0.980965,0.981132,0.981314,0.974965,0.975288,0.98374,0.976636,0.939394,0.94864,0.924138,0,0,0    },
    {0,0.985066,0.983506,0.987382,0.987145,0.986842,0.971071,0.973316,0.981295,0.977817,0.977041,0.973046,0.953125,0.962199,0.911565,0,0,0    },
    {0,0.984644,0.98285,0.987859,0.99053,0.984138,0.980435,0.974737,0.976994,0.979112,0.98133,0.970899,0.959654,0.94386,0.903475,0,0,0    },
    {0,0.98623,0.983907,0.985968,0.989104,0.989791,0.980681,0.984506,0.988561,0.975388,0.982589,0.976277,0.952941,0.947047,0.908676,0,0,0    },
    {0,0.992175,0.986218,0.993355,0.992046,0.987198,0.986986,0.988131,0.985931,0.984375,0.979924,0.97907,0.956298,0.962099,0.910596,0,0,0}
  };


  int tmpPtBin = FindMuonEfficiencyBin( Pt , ptBins, 15);
  int tmpEtaBin = FindMuonEfficiencyBin( Eta , etaBins, 16);
  return Efficiency[tmpPtBin][tmpEtaBin];
}
